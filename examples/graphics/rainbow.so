load "graphics.so";

var window = new Window("Rainbow", 600, 400, () => {
	println("Rainbow!");
	exit();
});
var graphics = window.getGraphics();
var i = 0;
var rectangle = new Shape.Rectangle(Color.HSLtoRGB(i, 1, 0.5), Color.BLACK, Random.int(25, window.width - 75), Random.int(25, window.height - 75), 50, 50);
var xm = 1;
var ym = 1;
graphics.add(rectangle);

refresh() => {
	i += 0.001;
	i >= 1 then {
		i = 0;
	}
	var color = Color.HSLtoRGB(i, 1, 0.5);
	rectangle.setFill(color);
	rectangle.move(xm, ym);
	rectangle.x > window.width - 50 || rectangle.x < 0 then {
		xm *= -1;
	}
	rectangle.y > window.height - 50 || rectangle.y < 0 then {
		ym *= -1;
	}
	window.repaint();
}

var start = timeMS();
true do {
	var lapse = timeMS() - start;
	lapse > 15 then {
		start = timeMS();
		refresh();
	}
}